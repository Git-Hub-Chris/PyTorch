from typing import Any

from .common import SymbolicGridFn


@SymbolicGridFn
def persistent_mm_grid(
    M: int, N: int, meta: dict[str, Any], *, cdiv: Any, min: Any
) -> tuple[int, int, int]:
    """Defines the grid for persistent kernels."""
    return (
        min(meta["NUM_SMS"], cdiv(M, meta["BLOCK_M"]) * cdiv(N, meta["BLOCK_N"])),
        1,
        1,
    )
